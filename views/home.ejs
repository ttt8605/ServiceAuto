<head>
    <link rel="stylesheet" href="/stylesheets/main.css">
  </head>
  <% layout('/layouts/boilerplate') %>
  
  <div class="media-container">
    <video class="responsive-video" autoplay loop muted playsinline>
      <source src="https://res.cloudinary.com/dn9nc0upp/video/upload/v1724835957/Untitled_nkqvyo.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
    <img class="responsive-image" src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1726121650/IMG_8556_lodnzd.jpg" alt="Responsive Image">
    <div class="OverVideoDiv">
       <h2>Text here</h2>
       <form action="/#MakeAnAppoinment">
        <button class="ProgrameazateButton">Programează-te aici<p class="ArrowButton">&rarr;</p></button>
       </form>
    </div>
    <div class="ButtonGroup">
        <form action="/program/#tabel"><button id="first" class="SelectButton">Program</button></form>
        <form action="/#contact"><button id="second"class="SelectButton">Contact</button></form>
        <form action="https://maps.app.goo.gl/uN2vfMr2XfX8zH1q8"><button id="third"class="SelectButton">Locație</button></form>
    </div>

  </div>

  <div class="container">
          <div class="ServiceCardTitleDiv" id="Services">
            <h3>Serviciile noastre</h3>
            <img src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1727330124/Vector_kbgdqx.svg" alt="">
          </div>
  <section class="serviceCard">
    <% for(let service of services) {%>
          <div class="card">
            <div class="left-service-side">
              <img src="<%= service.images[0].url %>"  alt="...">
            </div>
            <div class="right-service-side">
              <div class="right-side-top">
                <a href="/services/<%=service._id %>" class="right-side-top-title"><%=service.name%> &rarr;</a>
                <% if (currentUser && currentUser.role === 'manager') { %>
                <div class="right-side-top-buttons">
                  <a class="btn btn-warning me-2" href="/services/<%=service._id %>/edit">Modifică</a>
                    <form action="/services/<%=service._id %>?_method=DELETE" method="POST">
                        <button type="submit" class="btn btn-danger">Șterge</button>
                    </form>
                </div>
                <% } %>
              
              </div>
              <p id="limited-paragraph"><%=service.description %></p>

            </div>


          </div>


      <% } %>
  </section>
  <div class="line-div">
    <img src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1726126505/Line_5_eegm5k.svg" alt="" class="line">
  </div>

  <section class="Important-info-section">
    <div class="cube"><a href="/program">Program</a><a href="/program"><img class="arrowImg" src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1727425165/Vector_ar2k8n.svg" alt=""></a></div>
    <div class="cube" id="contact"><h2>Contact</h2><h3>0790217727</h3></div>
    <div class="cube">
      <a href="https://maps.app.goo.gl/uN2vfMr2XfX8zH1q8">Locație</a><a href="https://maps.app.goo.gl/uN2vfMr2XfX8zH1q8"><img class="arrowImg" src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1727425165/Vector_ar2k8n.svg" alt=""></a>
    </div>
  </section>
  

</div>
<section class="Text-Img">
<img src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1727504028/IMG_8667_xd4bmt.jpg" alt="">
<h1>Afacere de familie, condusă de profesioniști: <br> îngrijire auto sustenabilă  în care poți avea încredere</h1>
<form action="/#MakeAnAppoinment">
  <button class="ProgrameazateButton2">Programează-te aici<p class="ArrowButton2">&rarr;</p></button>
 </form>
</section>
<div class="container" id="container2">

<div class="line-div">
  <img src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1726126505/Line_5_eegm5k.svg" alt="" class="line">
</div>

<section class="Angajati-Section" id="Team">
  <div class="Angajati-title-div"> 
    <h1>Fă cunoștință cu echipa</h1>
    <img class="img-angajati" src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1727679531/Clip_path_group_uszlm6.svg" alt="">
  </div>
  <div class="angajat-carousel-control-buttons2">
    <button class="prev">&larr;</button>
    <button class="next">&rarr;</button>
  </div>
  <div class="carousel">
    <div class="carousel-container"> 
      <% for (let angajat of an) { %>
        <div class="AngajatiCard ">
          <div class="img-div-angajati">
            <img src="<%= angajat.images[0].url %>" alt="">
          </div>
          <div class="angajat-presentation-side">
            <div class="Title-roll-actionButtons">
              <div>
                <h3 class="nume-angajat"><%= angajat.name %></h3>
                <h4 class="rol-angajat"><%= angajat.role %></h4>
              </div>
              <div>
                <% if (currentUser && currentUser.role === 'manager') { %>
                  <div id="buttonsDiv" class="d-flex mb-2">
                    <a class="btn btn-warning me-2 mb-2" href="/angajati/<%= angajat._id %>/edit">Modifică</a>
                    <form action="/angajati/<%= angajat._id %>?_method=DELETE" method="POST">
                      <button type="submit" class="btn btn-info">Șterge</button>
                    </form>
                  </div>
                <% } %>
              </div>
            </div>
            <div class="text-angajat-div">
              <p class="about-angajat"><%= angajat.about %></p>
            </div>
          </div>
        </div>
      <% } %>
</div>
</div>
    <div class="angajat-carousel-control-buttons">
      <button class="prev">&larr;</button>
     <button class="next">&rarr;</button>
    </div>

</section>

<div class="line-div">
  <img src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1726126505/Line_5_eegm5k.svg" alt="" class="line">
</div>
<section class="projectSection">
  <h3 id="Projects"  >Proiectele noastre</h3>
   <div class="projects-loop">
    <% for(let post of postari) {%>
            <div class="post-card">
              <a href="/postari/<%=post._id %>">
              <img src="<%= post.images[0].url %>" class="img-post" alt="...">
              <div class="under-post-div">
              <h5><%=post.name%> &rarr;</h5>
              <% if (currentUser && currentUser.role === 'manager') { %>
              <div class="edit-delete-group">
              <a class="btn btn-warning me-2" href="/postari/<%=post._id %>/edit">Modifică</a>
              <form action="/postari/<%=post._id %>?_method=DELETE" method="POST">
                  <button type="submit" class="btn btn-danger">Șterge</button>
              </form>
              </div>
              <% } %>
              </div>
              </a>
                  </div>
        
          <% } %>
   </div>
   <button id="show-more-btn" class="show-btn">Vezi mai mult &darr;</button>
   <button id="show-less-btn" class="show-btn hidden">Vezi mai putin &uarr;</button>
</section>

</div>

<div class="Appointment-section-title">
  <h1>Programează-te aici</h1>
</div>
<section id="MakeAnAppoinment" class="Appointment-section">
<div class="img-div-appointment">
  <img src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1727941672/IMG_6358_u1n37k.jpg" alt="">
</div>
<div class="form-div-appointment">
  <form action="/programare" method="POST" class="validated-form" novalidate>
    <div class=" mb-3">
        <label for="model" class="form-label">Nume & prenume</label>
        <input type="text" name="name" id="name" class="form-control"  required>
        <div class="valid-feedback">
         Looks good!
        </div>
       </div>
    
       <div class=" mb-3">
        <label for="plate" class="form-label">Telefon</label>
        <input type="text" name="phone" id="phone" class="form-control"  required>
        <div class="valid-feedback">
         Looks good!
        </div>
       </div>
    
     
  
       <div class="mt-3 mb-3">
        <label for="date" class="form-label">Alege o dată</label>
        <select id="date" name="date" class="form-control mb-3" aria-label="Default select example">
            <% datesWithAvailableHours.forEach(dateObj => { %>
                <option value="<%= dateObj.date %>"><%= dateObj.date %></option>
            <% }) %>
        </select>
    </div>

   
<label for="ora" class="form-label">Alege ora</label>
<select id="ora" name="ora" class="form-control mb-3" aria-label="Default select example" required>
<% if (datesWithAvailableHours.length > 0 && datesWithAvailableHours[0].hours.length > 0) { %>
  <% datesWithAvailableHours[0].hours.forEach(hour => { %>
    <option value="<%= hour %>"><%= hour %></option>
  <% }) %>
<% } else { %>
  <option value="" disabled selected>Nu sunt programari disponibile</option>
<% } %>
</select>
           
           
    
    <button class="btn-block">Trimite</button>
    
    </form>
</div>

</section>



<div class="container">
  <section class="find-car">
    <div class="find-car-title">
      <h3>Ai deja mașina la noi? Aflăi statusul mai jos </h3>
    </div>
    <div class="line-div" id="FindCar">
      <img src="https://res.cloudinary.com/dn9nc0upp/image/upload/v1726126505/Line_5_eegm5k.svg" alt="" class="line">
    </div>
    <div class="find-car-form">
      <form action="/cars/search" method="GET" class="search-form">
      
            <!-- <label for="plate" class="form-label">Număr de înmatriculare</label> -->
            <input type="text" name="plate" id="plate" class="form-control" placeholder="Număr de înmatriculare" required>
      
        <button type="submit" class="btn">&rarr;</button>
      </form>
    </div>

  </section>

</div>






<script src="/javascripts/MainPage.js"></script>
<script>

//apointment js
function reverseDateFormat(dateString) {
    // Split the date string into its components
    const [year, month, day] = dateString.split('-');
    
    // Reformat the date components
    return `${day}/${month}/${year}`;
  }
  
  // Function to update the options in the select element
  function updateDateOptions() {
    const selectElement = document.getElementById('date');
    
    // Iterate over each option and update its text
    Array.from(selectElement.options).forEach(option => {
        const originalDate = option.value;
        option.text = reverseDateFormat(originalDate);
    });
  }
  
  // Call the function after the page loads
  document.addEventListener('DOMContentLoaded', updateDateOptions);
  
  // Attach a submit event listener to the form
  document.querySelector('form').addEventListener('submit', function() {
    // Convert the plate input value to uppercase before submitting the form
    const plateInput = document.getElementById('plate');
    plateInput.value = plateInput.value.toUpperCase();
  });
  
  
  const datesWithAvailableHours = <%- JSON.stringify(datesWithAvailableHours) %>;
  
  document.getElementById('date').addEventListener('change', function() {
  const selectedDate = this.value;
  const hoursSelect = document.getElementById('ora');
  const selectedDateObj = datesWithAvailableHours.find(dateObj => dateObj.date === selectedDate);
  
  // Clear previous options
  hoursSelect.innerHTML = '';
  
  // Populate hours for the selected date
  if (selectedDateObj) {
      selectedDateObj.hours.forEach(hour => {
          const option = document.createElement('option');
          option.value = hour;
          option.textContent = hour;
          hoursSelect.appendChild(option);
      });
  
  }
  });
  
  
  
  document.getElementById('myForm').addEventListener('submit', function(event) {
  const selectElement = document.getElementById('ora');
  const selectedValue = selectElement.value;
  
  // Prevent form submission if no valid option is selected
  if (selectedValue === "" || selectedValue === "No available times") {
  alert('Please select a valid time slot.');
  event.preventDefault(); // Prevent form submission
  }
  });
</script>

